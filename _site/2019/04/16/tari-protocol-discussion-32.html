<!DOCTYPE html>
<html class="no-js">
  <head>

    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tari Protocol Discussion 32</title>

<meta property="og:description" content="Tari is a new open source, decentralized protocol that reimagines the future of digital assets." />
<meta property="og:site_name" content="Tari" />
<meta property="og:title" content="Tari Protocol Discussion 32" />
<meta property="og:url" content="http://localhost:4000/2019/04/16/tari-protocol-discussion-32.html" />
<meta property="og:image" content="http://localhost:4000/tari-splash.png" />
<meta property="og:image:secure_url" content="http://localhost:4000/tari-splash.png" />
<meta property="og:type" content="website" />
  
<meta name="description" content="Tari is a new open source, decentralized protocol that reimagines the future of digital assets." />
<meta itemprop="name" content="Tari"/>
<meta itemprop="title" content="Tari Protocol Discussion 32" />
<meta itemprop="url" content="http://localhost:4000/2019/04/16/tari-protocol-discussion-32.html"/>
<meta itemprop="thumbnailUrl" content="http://localhost:4000/tari-splash.png"/>
<meta itemprop="image" content="http://localhost:4000/tari-splash.png" />
<link rel="image_src" href="http://localhost:4000/tari-splash.png" />
  
<meta name="twitter:site" content="Tari">
<meta name="twitter:title" content="Tari Protocol Discussion 32"/>
<meta name="twitter:url" content="http://localhost:4000/2019/04/16/tari-protocol-discussion-32.html"/>
<meta name="twitter:image" content="http://localhost:4000/tari-splash.png"/>
<meta name="twitter:card" content="summary"/>

<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

<!-- CSS -->
<link rel="stylesheet" href="/css/owl.carousel.css" />
<link rel="stylesheet" href="/css/bootstrap.min.css" />
<link rel="stylesheet" href="/css/avenir-std.css" />
<link rel="stylesheet" href="/css/font-awesome.min.css" />
<link rel="stylesheet" href="/css/airspace.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/ionicons.min.css" />
<link rel="stylesheet" href="/css/animate.css" />
<link rel="stylesheet" href="/css/responsive.css" />
<link rel="stylesheet" href="/css/syntax.css" />

<!-- Js -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/plugins.js"></script>
<script src="/js/min/rellax.min.js"></script>
<script src="/js/min/waypoints.min.js"></script>
<script src="/js/jquery.counterup.js"></script>

<script src="/js/main.js"></script>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b04a80b744e1cff"></script>



<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-115476091-1', 'auto');
    ga('send', 'pageview');
</script>


  </head>
  <body class="page-">


    <!-- Header Start -->
<header>
<div class="container">
  <div class="row">
    <!-- header Nav Start -->
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header col-md-4">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <span class="visible-xs-inline visible-sm-inline"><svg class="logo--gem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71.1"><path d="M29.1 0L0 18.9v19.8L28.9 71 70 38.8V18.9L29.1 0zM29.7 8L63 23.4V32L12.7 19 29.7 8zM32.5 31.4l26.8 6.9L32.5 59.3V31.4zM7 24.8l18.5 4.7v27.1L7 36V24.8z"/></svg></span>
            <svg class="logo--wordmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 53.3 18"><path d="M21.1 0L15 18h3.9l1.3-4.2h5.3l1.3 4.2h3.9L24.6 0H21.1zM21.2 10.5l1.6-5.4 1.6 5.4H21.2z"/><rect x="49.6" width="3.6" height="18"/><path d="m40 11.1c3.3-0.2 5.2-2.2 5.2-5.5 0-3.5-2.1-5.5-5.7-5.5h-6.8v18h3.6v-5.6l5 5.6h4.7l-6.2-6.9 0.2-0.1zm-3.6-3.4v-4.3h3.1c1.4 0 2.1 0.8 2.1 2.2s-0.7 2.2-2.1 2.2h-3.1z"/><polygon points="6.1 18 9.7 18 9.7 3.4 15.8 3.4 15.8 0 0 0 0 3.4 6.1 3.4"/></svg>

          </a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse col-md-8" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Documentation
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <ul>
                          <li><a class="dropdown-item" href="#">Installation guide</a></li>
                          <li> <a class="dropdown-item" href="https://rfc.tari.com/" target="_blank">Tari RFC</a></li>
                      </ul>


                  </div>
              </li>
            <li><a href="https://www.github.com/tari-project" target="_blank">Source code </a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="/faq">FAQ</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>
  </div>
</div>
</header><!-- header close -->



    <div class="post">

  <div class="container">
  <div class="row">
    <div class="col-md-8">

      <div class="post-img" style="background-image:url(/img/posts/protocol-discussion-32.png)">
          <img src="/img/posts/placeholder-spacer.gif" />
      </div>

      <div class="post-head">
        <h1>Tari Protocol Discussion 32</h1>
        <div class="row">
          <div class="col-sm-6">
            <div class="post-meta">
              <strong class="post-author">Tari Team</strong>
              <p class="post-date">April 16, 2019</p>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="addthis_inline_share_toolbox"></div>
          </div>
        </div>
      </div>

      <!-- Wrapper Start -->
      <section id="post">
        <div class="block">
          
          <p>On Monday, the Tari community discussed the mempool RFC. Below is the TL;DR on Monday’s conversation (full transcript included below):</p>

<p>RFC 0190 Mempool</p>

<ul>
  <li>Proposed to use 4 mempools: ransaction Pool, Pending Pool, Orphan Pool and Reorg Pool</li>
  <li>The mempools should be ordered with a priority</li>
  <li>Transactions should be ordered with a priority</li>
</ul>

<p>Join us for our next discussion on Freenode in #tari-dev.</p>

<p>Discussion times proposed by the Tari community:</p>

<p><strong>Mondays: 6pm CAT (12pm EST)</strong></p>

<p><strong>Thursdays: 11am CAT (5am EST)</strong></p>

<p>To keep up with the latest Tari developments, you can follow the project on <a href="https://twitter.com/tari">Twitter</a>.</p>

<h3 id="transcript-of-mondays-discussion">Transcript of Monday’s discussion</h3>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>18:00 &lt;neonknight64&gt;  Hello, I wonder if we can't talk about RFC0190 - Mempool: https://github.com/tari-project/tari/pull/229
18:02 &lt;neonknight64&gt;  The basic idea is that the Mempool consist of four sub pools: Transaction Pool, Pending Pool, Orphan Pool and Reorg Pool.
18:03 &lt;Blackwolfsa3&gt;  whats the reason for the reorg pool?
18:06 &lt;neonknight64&gt;  The Reorg pool is used as a short term backup for transactions that have been included in blocks. In case a blockchain reorganisation happens, the transactions used in the discarded blocks can be recovered and added back into the transaction pool so that they can be added to future blocks.
18:07 &lt;neonknight64&gt;  This will ensure that high priority transactions wont be discarded and wont need to be retransmitted
18:07 &lt;Blackwolfsa3&gt;  so its basically a nice to have so that the wallets dont have to watch for it?
18:07 &lt;@CjS77&gt;  hansie: Ok, I got you. Indeed it's non-trivial
18:08 &lt;neonknight64&gt;  I think, adding a Reorg pool could make the Mempool a bit more dependable
18:09 &lt;Blackwolfsa3&gt;  it should
18:12 &lt;neonknight64&gt;  So the Transaction pool contains only valid and ready-to-go transactions that could be added to blocks. The Pending Pool and Orphan pool deal with transactions that have timelocks, attempt to spend invalid UTXOs or UTXOs with timelocks.
18:14 &lt;@CjS77&gt;  Yeah,I don't see there being much overhead to running multiple pools, so you may as well have separate ones rather than having to sort &amp; filter a global pool all the time. No TX sits in more than one pool (except the reorg pool I guess), so it sounds good to me
18:14 &lt;Blackwolfsa3&gt;  do we need to separate two, I see no reason for a pending and orphan pool?
18:15 &lt;Blackwolfsa3&gt;  a tx can also theoretically sit in both
18:15 &lt;@CjS77&gt;  The pending pool could also be sorted by block so that it's really easy to pop off tx's into the main pool when a new block is found
18:16 &lt;@CjS77&gt;  I suggest: If it's an orphan, it should go to the orphan pool, even if it would also be pending. If its parent appears, it should move to pending.
18:17 &lt;neonknight64&gt;  I think a transaction should only every exist in one pool at a time. I agree with CjS77, the pools could be prioritized like that.
18:20 &lt;neonknight64&gt;  Blackwolfsa3, currently the pending pool deals with timelock restricted transactions that could be sorted efficiently like CjS77 suggested. The transactions in the Orphan pool might get discarded regularly as they reach the maturity threshold and could not be moved to the transaction pool.
18:21 &lt;neonknight64&gt;  Managing them separately might make implementation easier.
18:22 &lt;stanimal&gt;  "Pending transactions that have matured past the discard threshold MUST be discarded and removed from the Pending Pool." - what is the discard threshold and why would a transaction sit in the mempool long enough to be discarded?
18:24 &lt;neonknight64&gt;  Mmmm that doesn't seem right, that mechanism is for the Orphan Pool or Reorg Pool.
18:25 &lt;stanimal&gt;  Ah yes, that makes more sense
18:26 &lt;neonknight64&gt;  If an orphaned transaction could not be moved to the transaction pool within a specified amount of time (threshold) its might never be spendable and should be removed at some point
18:28 &lt;neonknight64&gt;  The RFC proposes a priority metric to prioritise transactions when storage limits are reached, any ideas how this could be improved?
18:30 &lt;neonknight64&gt;  Currently, transactions spending UTXOs with higher block height maturity must be prioritized over transactions spending UTXOs
18:30 &lt;neonknight64&gt;   with lower block height maturity. Also, transactions with higher fees per transaction message size must be prioritized over lower fee transactions.
18:35 &lt;stanimal&gt;  What data points do we have? Obviously not value of the transaction. Maturity (age), fees... anything else?
18:35 &lt;Blackwolfsa3&gt;  type?
18:36 &lt;Hansie&gt;  Hi
18:41 &lt;neonknight64&gt;  Type maybe.. I fear that time-locked transactions will be discarded to make room for higher priority valid transactions that could be included into blocks.
18:41 &lt;Blackwolfsa3&gt;  whould timelocked not be in pending anyway?
18:42 &lt;Blackwolfsa3&gt;  I was thinking more along the lines of vn registration etc
18:42 &lt;stanimal&gt;  Would the time spent locked not count towards the maturity?
18:42 &lt;Hansie&gt;  It should
18:42 &lt;Hansie&gt;  But is maturity not just binary? Mature or not mature?
18:43 &lt;neonknight64&gt;  Aaah I see, that "type" could possibly work.
18:43 &lt;stanimal&gt;  Think type can definitely enter in the heuristic - though initially we only have coinbase (timelocked) and regular?
18:45 &lt;Hansie&gt;  Maybe the 'must' should turn to 'should'. Miners will decide what they want to do, which valid Txs they want to include.
18:45 &lt;Hansie&gt;  stanimal: I think yes
18:49 &lt;Hansie&gt;  neonknight: Will `threshold expiration time` for the reorg pool be similar to the horizon for fast sync?
18:51 &lt;neonknight64&gt;  The threshold expiration time will be short for transactions in the Reorg pool, probably something like 30-60min
18:51 &lt;neonknight64&gt;  Not sure if it is similar to horizon for fast sync..
18:53 &lt;Hansie&gt;  Ok
18:53 &lt;Hansie&gt;  Just wondering about the enforce-ability of the 'transaction priority metric '...
18:56 &lt;Hansie&gt;  I think miners will be motivated by higher earnings.
18:58 &lt;neonknight64&gt;  I agree miner are earning driven, probably not enforceable but recommended
18:58 &lt;Hansie&gt;  I like the idea that wallets can track incoming payments, and possibly the state of a particular Tx
19:02 &lt;Hansie&gt;  This may assist front-running: "mechanism to estimate fee categories from the current Mempool state" ?
19:03 &lt;Hansie&gt;  neonknight64: I think the RFC seems solid, apart from some of the comments made here that warrants some thought.
19:06 &lt;neonknight64&gt;  Thank you for the suggestions and comments, I will go think how it can be improved.
19:09 &lt;stanimal&gt;  Agree, think there's some great ideas to run with!
</code></pre></div></div>

        </div>
      </section>

    </div>
  </div>
</div>
</div>

<!-- Call to action Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <a class="btn btn-lg" href="/blog">Back to blog</a>
                </div>
            </div>
        </div>
    </div>
</section>










    <!-- footer Start -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-1">

        <svg class="logo--gem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71.1"><path d="M29.1 0L0 18.9v19.8L28.9 71 70 38.8V18.9L29.1 0zM29.7 8L63 23.4V32L12.7 19 29.7 8zM32.5 31.4l26.8 6.9L32.5 59.3V31.4zM7 24.8l18.5 4.7v27.1L7 36V24.8z"/></svg>

      </div>
      <div class="col-md-5">

        <h1>Built in <strong>Oakland</strong> &amp; <strong>Johannesburg</strong></h1>

        <form id="email_signup" class=" klaviyo_bare_embed_L5CjJF" action="//manage.kmail-lists.com/subscriptions/subscribe" data-ajax-submit="//manage.kmail-lists.com/ajax/subscriptions/subscribe" method="GET" target="_blank" novalidate="novalidate">
  <input type="hidden" name="g" value="L5CjJF">
  <div class="klaviyo_messages">
    <div class="success_message" style="display:none;"></div>
    <div class="error_message" style="display:none;"></div>
  </div>
  <div class="klaviyo_field_group">
    <label for="k_id_email">Newsletter Sign Up</label>
    <input type="email" value="" name="email" id="k_id_email" placeholder="Enter email" />
  </div>
  <div class="klaviyo_form_actions">
    <button type="submit" class="btn btn-lg klaviyo_submit_button">Submit</button>
  </div>
  <p class="privacy-agreement">By clicking ‘Submit’, you agree to our <a href="/privacy_policy" title="Privacy Policy" target="_blank">Privacy Policy</a>.</p>
</form>
<script type="text/javascript" src="//www.klaviyo.com/media/js/public/klaviyo_subscribe.js"></script>
<script type="text/javascript">
  KlaviyoSubscribe.attachToForms('#email_signup', {
    hide_form_on_success: true
  });
</script>

        <p>Copyright &copy; 2018 Tari Labs, LLC. All rights reserved.<br/>
          <a href="/privacy_policy">Privacy Policy</a>&nbsp;
          <a href="/disclaimer">Disclaimer</a>.
        </p>

      </div>
      <div class="col-md-6">
        <div class="footer-menu clearfix">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/docs">Docs</a></li>
            <li><a href="https://rfc.tari.com/" target="_blank">Tari RFC</a></li>
            <li><a href="https://www.github.com/tari-project" target="_blank">Source code</a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="/faq">FAQ</a></li>
          </ul>
        </div>
        <div class="footer-socials">
          <ul class="social-icons">
            <li><a href="https://www.twitter.com/tari" target="_blank"><i class="ion-social-twitter"></i></a></li>
            <li><a href="https://www.facebook.com/tarilabs" target="_blank"><i class="ion-social-facebook"></i></a></li>
            <li><a href="https://www.reddit.com/r/tari" target="_blank"><i class="ion-social-reddit"></i></a></li>
            <li><a href="https://www.github.com/tari-project" target="_blank"><i class="ion-social-github"></i></a></li>
            <li><a href="https://t.me/tarilab" target="_blank"><i class="ion-paper-airplane"></i></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>


    </body>
</html>
