<!DOCTYPE html>
<html class="no-js">
  <head>

    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>Tari Protocol Discussion 12</title>

<meta property="og:description" content="Tari is a new open source, decentralized protocol that reimagines the future of digital assets." />
<meta property="og:site_name" content="Tari" />
<meta property="og:title" content="Tari Protocol Discussion 12" />
<meta property="og:url" content="http://localhost:4000/2018/12/09/tari-protocol-discussion-12.html" />
<meta property="og:image" content="http://localhost:4000/tari-splash.png" />
<meta property="og:image:secure_url" content="http://localhost:4000/tari-splash.png" />
<meta property="og:type" content="website" />
  
<meta name="description" content="Tari is a new open source, decentralized protocol that reimagines the future of digital assets." />
<meta itemprop="name" content="Tari"/>
<meta itemprop="title" content="Tari Protocol Discussion 12" />
<meta itemprop="url" content="http://localhost:4000/2018/12/09/tari-protocol-discussion-12.html"/>
<meta itemprop="thumbnailUrl" content="http://localhost:4000/tari-splash.png"/>
<meta itemprop="image" content="http://localhost:4000/tari-splash.png" />
<link rel="image_src" href="http://localhost:4000/tari-splash.png" />
  
<meta name="twitter:site" content="Tari">
<meta name="twitter:title" content="Tari Protocol Discussion 12"/>
<meta name="twitter:url" content="http://localhost:4000/2018/12/09/tari-protocol-discussion-12.html"/>
<meta name="twitter:image" content="http://localhost:4000/tari-splash.png"/>
<meta name="twitter:card" content="summary"/>

<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

<!-- CSS -->
<link rel="stylesheet" href="/css/owl.carousel.css" />
<link rel="stylesheet" href="/css/bootstrap.min.css" />
<link rel="stylesheet" href="/css/avenir-std.css" />
<link rel="stylesheet" href="/css/font-awesome.min.css" />
<link rel="stylesheet" href="/css/airspace.css" />
<link rel="stylesheet" href="/css/style.css" />
<link rel="stylesheet" href="/css/ionicons.min.css" />
<link rel="stylesheet" href="/css/animate.css" />
<link rel="stylesheet" href="/css/responsive.css" />
<link rel="stylesheet" href="/css/syntax.css" />

<!-- Js -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="js/vendor/jquery-1.10.2.min.js"><\/script>')</script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/plugins.js"></script>
<script src="/js/min/rellax.min.js"></script>
<script src="/js/min/waypoints.min.js"></script>
<script src="/js/jquery.counterup.js"></script>

<script src="/js/main.js"></script>

<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5b04a80b744e1cff"></script>



<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-115476091-1', 'auto');
    ga('send', 'pageview');
</script>


  </head>
  <body class="page-">


    <!-- Header Start -->
<header>
<div class="container">
  <div class="row">
    <!-- header Nav Start -->
    <nav class="navbar navbar-default">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header col-md-4">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">
            <span class="visible-xs-inline visible-sm-inline"><svg class="logo--gem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71.1"><path d="M29.1 0L0 18.9v19.8L28.9 71 70 38.8V18.9L29.1 0zM29.7 8L63 23.4V32L12.7 19 29.7 8zM32.5 31.4l26.8 6.9L32.5 59.3V31.4zM7 24.8l18.5 4.7v27.1L7 36V24.8z"/></svg></span>
            <svg class="logo--wordmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 53.3 18"><path d="M21.1 0L15 18h3.9l1.3-4.2h5.3l1.3 4.2h3.9L24.6 0H21.1zM21.2 10.5l1.6-5.4 1.6 5.4H21.2z"/><rect x="49.6" width="3.6" height="18"/><path d="m40 11.1c3.3-0.2 5.2-2.2 5.2-5.5 0-3.5-2.1-5.5-5.7-5.5h-6.8v18h3.6v-5.6l5 5.6h4.7l-6.2-6.9 0.2-0.1zm-3.6-3.4v-4.3h3.1c1.4 0 2.1 0.8 2.1 2.2s-0.7 2.2-2.1 2.2h-3.1z"/><polygon points="6.1 18 9.7 18 9.7 3.4 15.8 3.4 15.8 0 0 0 0 3.4 6.1 3.4"/></svg>

          </a>
        </div>
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse col-md-8" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
              <li class="nav-item dropdown">
                  <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                      Documentation
                  </a>
                  <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                      <ul>
                          <li><a class="dropdown-item" href="#">Installation guide</a></li>
                          <li> <a class="dropdown-item" href="https://rfc.tari.com/" target="_blank">Tari RFC</a></li>
                      </ul>


                  </div>
              </li>
            <li><a href="https://www.github.com/tari-project" target="_blank">Source code </a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="/faq">FAQ</a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>
  </div>
</div>
</header><!-- header close -->



    <div class="post">

  <div class="container">
  <div class="row">
    <div class="col-md-8">

      <div class="post-img" style="background-image:url(/img/posts/protocol-discussion-12.png)">
          <img src="/img/posts/placeholder-spacer.gif" />
      </div>

      <div class="post-head">
        <h1>Tari Protocol Discussion 12</h1>
        <div class="row">
          <div class="col-sm-6">
            <div class="post-meta">
              <strong class="post-author">Tari Team</strong>
              <p class="post-date">December 09, 2018</p>
            </div>
          </div>
          <div class="col-sm-6">
            <div class="addthis_inline_share_toolbox"></div>
          </div>
        </div>
      </div>

      <!-- Wrapper Start -->
      <section id="post">
        <div class="block">
          
          <p>Monday‚Äôs Tari protocol architecture discussion was all about the base layer modules of <a href="https://github.com/tari-project/RFC/blob/master/proposals/181107-base-layer-architecture.md">Tari‚Äôs architecture proposal</a>. Specifically, a few questions needed to be answered, as the above architecture proposal is only a rough draft. Questions like:</p>

<ul>
  <li>Are the main moving parts of the base layer covered in the architecture proposal?</li>
  <li>Should the design layout for the code be grouped by function or by software stack?</li>
  <li>Does the Tari protocol architecture align with the folder structure proposal?</li>
  <li>Are Tari‚Äôs base layer modules sufficiently decoupled from each other?</li>
</ul>

<p>The full discussion was one of the most vibrant Tari community discussions to date, and set the stage for a Thursday discussion on 2nd layer protocol architecture.</p>

<p>Join us for our next discussion on Freenode in #tari-dev.
Discussion times proposed by the Tari community:</p>

<p><strong>Mondays: 8pm CAT (1pm EST)</strong></p>

<p><strong>Thursdays: 11am CAT (4am EST)</strong></p>

<p>To keep up with the latest Tari developments, you can follow the project on <a href="https://twitter.com/tari">Twitter</a>.</p>

<h3 id="transcript-of-mondays-discussion">Transcript of Monday‚Äôs discussion</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10:01 AM &lt;@cjs77&gt; Hey all
10:01 AM &lt;simian_za&gt; Hiya
10:02 AM &lt;neonknight&gt; Hello..
10:02 AM &lt;@cjs77&gt; I thought we‚Äôd discuss the project layout tonight
10:02 AM &lt;Hansie&gt; Hi there
10:02 AM &lt;Hansie&gt; Sounds interesting yes
10:03 AM &lt;@cjs77&gt; ref: https://github.com/tari-project/tari/pull/2
10:04 AM &lt;@cjs77&gt; with context: https://github.com/tari-project/RFC/tree/master/proposals
10:04 AM &lt;@cjs77&gt; In particular the high-level and base-layer proposals
10:04 AM &lt;tk___&gt; hey
10:05 AM &lt;@cjs77&gt; mikethetike had a suggestion:
10:05 AM &lt;@cjs77&gt; &gt; I would have put all the base_layer folders in the root, and just had the digital_assets_layer as digital_assets
10:06 AM &lt;stanimal&gt; Hey everyone
10:06 AM &lt;@cjs77&gt; For those who don‚Äôt RTFM, here‚Äôs a summary:
10:06 AM &lt;@cjs77&gt; &gt; The code follows a domain-driven design layout, with top-level folders falling into infrastructure, domain, or application layers.
10:06 AM &lt;@cjs77&gt; The infrastructure folder contains code that is not Tari-specific. It holds the following crates:
10:06 AM &lt;@cjs77&gt; comms: The networking and messaging subsystem
10:06 AM &lt;@cjs77&gt; crypto: All cryptographic services, including a Curve25519 implementation
10:06 AM &lt;@cjs77&gt; storage: Data persistence services, including LMDB
10:06 AM &lt;@cjs77&gt; The base_layer is a domain-level folder and contains:
10:06 AM &lt;@cjs77&gt; core: common classes and traits, such as Transactions and Blocks
10:06 AM &lt;@cjs77&gt; blockchain: The Tari consensus code
10:06 AM &lt;@cjs77&gt; mempool: The unconfirmed transaction pool implementation
10:06 AM &lt;@cjs77&gt; mining: The merge-mining modules
10:06 AM &lt;@cjs77&gt; p2p: The block and transaction propagation module
10:06 AM &lt;@cjs77&gt; api: interfaces for clients and wallets to interact with the base layer components
10:06 AM &lt;@cjs77&gt; The digital_assets_layer is a domain-level folder contains code related to the management of native Tari digital assets. Substructure TBD.
10:06 AM &lt;@cjs77&gt; It‚Äôs envisaged that at least the following applications are built on top of the domain layer libraries:
10:06 AM &lt;@cjs77&gt; A standalone miner (tari_miner)
10:06 AM &lt;@cjs77&gt; A pool miner (tari_pool_miner)
10:06 AM &lt;@cjs77&gt; A CLI wallet for the Tari cryptocurrency (cli_wallet)
10:06 AM &lt;@cjs77&gt; A full node executable (tari_basenode)
10:07 AM &lt;simian_za&gt; wont the digital assets layer also have its own p2p and api crates? If so then it would make sense to keep the current structure
10:08 AM &lt;@cjs77&gt; https://www.irccloud.com/pastebin/I5ZeLnAX/
10:08 AM &lt;@cjs77&gt; That‚Äôs better :)
10:08 AM &lt;@cjs77&gt; simian_za: that‚Äôs why I ultimately proposed the current structure
10:09 AM &lt;@cjs77&gt; There will be name clashes since we‚Äôre not just building a mimblewimble implem,entation, but a digital assets network as well
10:10 AM &lt;simian_za&gt; In terms of the applications I feel like the tari_miner and tari_pool_miner will be more tightly coupled
10:10 AM &lt;Blackwolfsa&gt; this makes more since, putting the da layer and base layer seperate
10:11 AM &lt;Hansie&gt; Yip, I would go with functional groupings rather than software stack groupings
10:12 AM &lt;Hansie&gt; We may potentially have multiple consensus algorithms/schemes/protocols, where would they live? Infrastructure?
10:13 AM &lt;simian_za&gt; if they relate to the base-layer in /base_layer/blockchain and for the digital_assets_layer in a folder related to consensus?
10:14 AM &lt;@cjs77&gt; If they‚Äôre blockchain agnostic, then they should go in infrastructure; with a suitable abstraction layer; If they use blockchain language, then they‚Äôre domain layer
10:16 AM &lt;@cjs77&gt; A more clearcut example is a datastore like LMDB. It‚Äôs infra. A websocket library is infra. I‚Äôd argue that ECC libraries are also infra
10:17 AM &lt;Hansie&gt; I think it would potentially be applicable to both layers, but more so the 2nd layer
10:17 AM &lt;Hansie&gt; Plug-gable consensus perhaps‚Ä¶
10:18 AM &lt;simian_za&gt; my gut says consensus algorithms would be fairly closely tied to their respective layers? But I suppose we might get really good at writing very modular code
10:18 AM &lt;neonknight&gt; The ‚ÄúBlockchain‚Äù section of ‚Äúinfrastructure‚Äù already says ‚ÄúThe Tari consensus code‚Äù, might work well there.
10:19 AM &lt;@cjs77&gt; yeah it depends what you mean by consensus algo. Nakamoto consensus is pretty tightly coupled to the base layer :)
10:19 AM &lt;Blackwolfsa&gt; but going by the design, the consensus on the base and second layer would be fundamentally different
10:21 AM &lt;simian_za&gt; what else would be in the base_layer/blockchain folder? the datastructures to store the blockchain, all the merkle proofs to determine the chains validity and?
10:21 AM &lt;Hansie&gt; We may have some consensus re-use if there is a case where consensus is needed on the base layer for some arbitration on the 2nd layer?
10:22 AM &lt;simian_za&gt; I feel like that consensus code would like in the second layer crates and then be pulled into the base_layer from there
10:22 AM &lt;simian_za&gt; like = live
10:23 AM &lt;@cjs77&gt; In any event, with the folder structure ¬±locked in, and given the alignment with the high-level architecture, we can start to map out some milestones and initial tickets for the independent modules
10:23 AM &lt;@cjs77&gt; and then you guys can go and play with some code :)
10:24 AM &lt;simian_za&gt; woop woop, finally!
10:24 AM &lt;neonknight&gt; That will be a good day
10:24 AM &lt;Hansie&gt; @simian_za, ‚Äúwhat else would be in the base_layer/blockchain folder?‚Äù maybe something to do with emission schedule, token management, inflation, block times, etc.
10:28 AM &lt;simian_za&gt; üëå
10:28 AM &lt;Hansie&gt; Where ‚Äòsmart contracts‚Äô, ‚Äòscript-less scripts‚Äô?
10:29 AM &lt;simian_za&gt; hmm that‚Äôs a good question. Those will be coupled to both the base-layer and second layer
10:29 AM &lt;Blackwolfsa&gt; I would probably think more base layer
10:31 AM &lt;Hansie&gt; Also, perhaps an asset_management application for the asset issuer?
10:32 AM &lt;simian_za&gt; perhaps just a GUI wallet that can handle interaction with the base and second layers?
10:32 AM &lt;mikethetike&gt; I think most of the other coins build that into the default wallet
10:35 AM &lt;Hansie&gt; I feel uneasy about that @mikethetike, adding things in one application with very little in common, or am I mistaken?
10:36 AM &lt;simian_za&gt; traditionally the wallet application is where the client functionality lives
10:36 AM &lt;mikethetike&gt; The wallet functionality is really small
10:36 AM &lt;mikethetike&gt; in most coins
10:36 AM &lt;@cjs77&gt; scriptless scripts are split between domain and infra. e.g. a generic signature aggregation scheme (e.g. MuSig) falls under infra, but an atomic swap would be built on those primitives in the domain layer
10:36 AM &lt;Blackwolfsa&gt; Both would likely be written as a small library, to implement both would be trivial
10:37 AM &lt;@cjs77&gt; a wallet is an executable though, and shouldn‚Äôt be in the libraries
10:37 AM &lt;Blackwolfsa&gt; yes, but I would believe most of the functionality should be written as libraries
10:37 AM &lt;@cjs77&gt; yeah the API will be a library
10:38 AM &lt;@cjs77&gt; That makes it easy to write a CLI wallet and a GUI wallet without repeating any code
10:39 AM &lt;Hansie&gt; @cjs77, you lost me with ‚Äòdomain layer‚Äô, is that in the folder structure? Or should I read between the lines‚Ä¶
10:41 AM &lt;@cjs77&gt; Domain layers are layers that contain the business language &amp; logic. For Tari there are basically 2 domain layers: The base_layer and digital_asset_layer. They‚Äôre broadly independent, hence they‚Äôre separate, but they‚Äôre both built using domain language terms like `Block`, `Transaction`, `TariAmount` etc. Does that make sense?
10:42 AM &lt;Hansie&gt; Perfect thanks :-)
10:45 AM &lt;Hansie&gt; So i.t.o. applications, if we have a ‚Äòtari_basenode‚Äô should we have a ‚Äòtari_validator_node‚Äô?
10:45 AM &lt;@cjs77&gt; blackwolfsa: re: If I infer where you were getting at with your comment about applications‚Ää‚Äî‚Ääif we do this properly, the applications are mostly just wiring things up, right? I mean the CLI app code shouldn‚Äôt be more than a few hundred lines (read config; get input; relay to API, return results)
10:45 AM &lt;@cjs77&gt; Hansie: yup
10:45 AM &lt;@cjs77&gt; but we haven‚Äôt really discussed what the 2nd layer looks like yet
10:45 AM &lt;Blackwolfsa&gt; yes, correct
10:46 AM &lt;Hansie&gt; Good
10:46 AM &lt;@cjs77&gt; Maybe we should start that conversatoin on Thurs
10:47 AM &lt;Hansie&gt; Great idea
10:51 AM &lt;simian_za&gt; It is a nice context to start thinking about the components we need to build
10:51 AM &lt;@cjs77&gt; +1
10:55 AM &lt;@cjs77&gt; Cool, so I‚Äôll merge that PR in; and then there‚Äôs a small PR for some crypto primitives that sort of illustrate my thinking around abstraction, documentation and testing, which everyone is welcome to comment on
10:56 AM &lt;Hansie&gt; Cool
10:56 AM &lt;simian_za&gt; üëç
</code></pre></div></div>

        </div>
      </section>

    </div>
  </div>
</div>
</div>

<!-- Call to action Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <a class="btn btn-lg" href="/blog">Back to blog</a>
                </div>
            </div>
        </div>
    </div>
</section>










    <!-- footer Start -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-md-1">

        <svg class="logo--gem" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 70 71.1"><path d="M29.1 0L0 18.9v19.8L28.9 71 70 38.8V18.9L29.1 0zM29.7 8L63 23.4V32L12.7 19 29.7 8zM32.5 31.4l26.8 6.9L32.5 59.3V31.4zM7 24.8l18.5 4.7v27.1L7 36V24.8z"/></svg>

      </div>
      <div class="col-md-5">

        <h1>Built in <strong>Oakland</strong> &amp; <strong>Johannesburg</strong></h1>

        <form id="email_signup" class=" klaviyo_bare_embed_L5CjJF" action="//manage.kmail-lists.com/subscriptions/subscribe" data-ajax-submit="//manage.kmail-lists.com/ajax/subscriptions/subscribe" method="GET" target="_blank" novalidate="novalidate">
  <input type="hidden" name="g" value="L5CjJF">
  <div class="klaviyo_messages">
    <div class="success_message" style="display:none;"></div>
    <div class="error_message" style="display:none;"></div>
  </div>
  <div class="klaviyo_field_group">
    <label for="k_id_email">Newsletter Sign Up</label>
    <input type="email" value="" name="email" id="k_id_email" placeholder="Enter email" />
  </div>
  <div class="klaviyo_form_actions">
    <button type="submit" class="btn btn-lg klaviyo_submit_button">Submit</button>
  </div>
  <p class="privacy-agreement">By clicking ‚ÄòSubmit‚Äô, you agree to our <a href="/privacy_policy" title="Privacy Policy" target="_blank">Privacy Policy</a>.</p>
</form>
<script type="text/javascript" src="//www.klaviyo.com/media/js/public/klaviyo_subscribe.js"></script>
<script type="text/javascript">
  KlaviyoSubscribe.attachToForms('#email_signup', {
    hide_form_on_success: true
  });
</script>

        <p>Copyright &copy; 2018 Tari Labs, LLC. All rights reserved.<br/>
          <a href="/privacy_policy">Privacy Policy</a>&nbsp;
          <a href="/disclaimer">Disclaimer</a>.
        </p>

      </div>
      <div class="col-md-6">
        <div class="footer-menu clearfix">
          <ul>
            <li><a href="/">Home</a></li>
            <li><a href="/docs">Docs</a></li>
            <li><a href="https://rfc.tari.com/" target="_blank">Tari RFC</a></li>
            <li><a href="https://www.github.com/tari-project" target="_blank">Source code</a></li>
            <li><a href="/blog">Blog</a></li>
            <li><a href="/faq">FAQ</a></li>
          </ul>
        </div>
        <div class="footer-socials">
          <ul class="social-icons">
            <li><a href="https://www.twitter.com/tari" target="_blank"><i class="ion-social-twitter"></i></a></li>
            <li><a href="https://www.facebook.com/tarilabs" target="_blank"><i class="ion-social-facebook"></i></a></li>
            <li><a href="https://www.reddit.com/r/tari" target="_blank"><i class="ion-social-reddit"></i></a></li>
            <li><a href="https://www.github.com/tari-project" target="_blank"><i class="ion-social-github"></i></a></li>
            <li><a href="https://t.me/tarilab" target="_blank"><i class="ion-paper-airplane"></i></a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</footer>


    </body>
</html>
